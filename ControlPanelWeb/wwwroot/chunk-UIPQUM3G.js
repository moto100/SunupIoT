import{a as Xe,b as Je}from"./chunk-NZA2KI6N.js";import{a as Ie,h as Me,l as Ke}from"./chunk-PEUSVQFR.js";import{a as se,b as A,c as le}from"./chunk-JXBRMWZB.js";import{Ca as Y,D as me,Da as K,Ea as ce,F as $,Fa as X,Ga as J,Ha as Q,Ja as Z,Ma as Oe,Na as Ue,O as De,Oa as Le,Pa as qe,Q as Re,Qa as ue,Ra as de,Sa as Ge,Ta as $e,U as Be,Ua as We,Va as je,Wa as He,Xa as Ye,k as Te,m as F,n as g,na as Ve,o as O,oa as Ae,p as U,pa as Fe,q as Ee,s as Pe,sa as W,u as L,ua as j,w as q,xa as H,z as G}from"./chunk-DTT4EXDO.js";import{Db as l,Eb as m,Eg as V,Fb as xe,Ga as h,Hb as x,Hg as E,Ia as p,J as te,Kc as B,Kf as ke,Kg as pe,Lc as ae,Lf as k,Mf as I,Na as Ce,Of as T,Pb as ne,Qf as M,Ra as _,Wa as o,Xa as s,Ya as z,Z as d,aa as b,ab as ie,db as y,fb as P,ha as D,ia as R,ib as _e,nc as oe,ob as w,pb as u,qb as C,rb as v,tb as Se,ub as be,vb as ye,wb as re,xb as N,ya as r,yb as Ne,zb as we}from"./chunk-AYH25EOF.js";import{a as ge}from"./chunk-MON7YFGF.js";var Qe=(()=>{let i=class i{constructor(){this.socialService=d(A),this.settingsSrv=d(V),this.type=""}ngOnInit(){this.mockModel()}mockModel(){let t={token:"123456789",name:"cipchk",email:`${this.type}@${this.type}.com`,id:1e4,time:+new Date};this.settingsSrv.setUser(ge(ge({},this.settingsSrv.user),t)),this.socialService.callback(t)}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=b({type:i,selectors:[["app-callback"]],inputs:{type:"type"},standalone:!0,features:[re([A]),N],decls:0,vars:0,template:function(n,a){},encapsulation:2});let e=i;return e})();var rt=(()=>{let i=class i{constructor(){this.tokenService=d(se),this.settings=d(V),this.router=d(B),this.f=new Ee({password:new Pe("",{nonNullable:!0,validators:[g.required]})})}get user(){return this.settings.user}submit(){this.f.controls.password.markAsDirty(),this.f.controls.password.updateValueAndValidity(),this.f.valid&&(console.log("Valid!"),console.log(this.f.value),this.tokenService.set({token:"123"}),this.router.navigate(["dashboard"]))}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=b({type:i,selectors:[["passport-lock"]],standalone:!0,features:[N],decls:15,vars:11,consts:[[1,"ant-card","width-lg",2,"margin","0 auto"],[1,"ant-card-body"],[1,"avatar"],["nzIcon","user","nzSize","large",3,"nzSrc"],["nz-form","","role","form",1,"mt-md",3,"ngSubmit","formGroup"],[3,"nzErrorTip"],["nzSuffixIcon","lock"],["type","password","nz-input","","formControlName","password"],["nz-row","","nzType","flex","nzAlign","middle"],["nz-col","",2,"text-align","right",3,"nzOffset","nzSpan"],["nz-button","","nzType","primary",3,"disabled"]],template:function(n,a){n&1&&(o(0,"div",0)(1,"div",1)(2,"div",2),z(3,"nz-avatar",3),s(),o(4,"form",4),y("ngSubmit",function(){return a.submit()}),o(5,"nz-form-item")(6,"nz-form-control",5),l(7,"i18n"),o(8,"nz-input-group",6),z(9,"input",7),s()()(),o(10,"div",8)(11,"div",9)(12,"button",10),u(13),l(14,"i18n"),s()()()()()()),n&2&&(r(3),p("nzSrc",a.user.avatar),r(),p("formGroup",a.f),r(2),p("nzErrorTip",m(7,7,"validation.password.required")),r(5),p("nzOffset",12)("nzSpan",12),r(),p("disabled",!a.f.valid),r(),C(m(14,9,"app.lock")))},dependencies:[$,L,F,O,U,q,G,E,$e,Ge,Z,K,Y,J,X,Q,ce,M,T,k,I,H,W,j],styles:["[_nghost-%COMP%]     .ant-card-body{position:relative;margin-top:80px}[_nghost-%COMP%]     .avatar{position:absolute;top:-20px;left:50%;margin-left:-20px}"]});let e=i;return e})();function ct(e,i){if(e&1&&z(0,"nz-alert",15),e&2){let c=P();p("nzType","error")("nzMessage",c.error)("nzShowIcon",!0)}}var nt=(()=>{let i=class i{constructor(){this.router=d(B),this.settingsService=d(V),this.socialService=d(A),this.reuseTabService=d(qe,{optional:!0}),this.tokenService=d(se),this.startupSrv=d(Me),this.http=d(pe),this.cdr=d(ne),this.form=d(me).nonNullable.group({userName:["",[g.required]],password:["",[g.required]],mobile:["",[g.required]],captcha:["",[g.required]],remember:[!0]}),this.error="",this.type=0,this.loading=!1,this.count=0}switch({index:t}){this.type=t}getCaptcha(){let t=this.form.controls.mobile;if(t.invalid){t.markAsDirty({onlySelf:!0}),t.updateValueAndValidity({onlySelf:!0});return}this.count=59,this.interval$=setInterval(()=>{this.count-=1,this.count<=0&&clearInterval(this.interval$)},1e3)}submit(){if(this.error="",this.type===0){let{userName:t,password:n}=this.form.controls;if(t.markAsDirty(),t.updateValueAndValidity(),n.markAsDirty(),n.updateValueAndValidity(),t.invalid||n.invalid)return}else{let{mobile:t,captcha:n}=this.form.controls;if(t.markAsDirty(),t.updateValueAndValidity(),n.markAsDirty(),n.updateValueAndValidity(),t.invalid||n.invalid)return}this.loading=!0,this.cdr.detectChanges(),this.http.post("controlpanel/www?_allow_anonymous=true",{type:this.type,function:"Login",userName:this.form.value.userName,password:this.form.value.password},null,{context:new oe().set(le,!0)}).pipe(te(()=>{this.loading=!1,this.cdr.detectChanges()})).subscribe(t=>{if(t.Status!==200){this.error=t.Message;return}this.reuseTabService?.clear(),t.Data.expired=+new Date+1e3*60*5,this.tokenService.set(t.Data),this.startupSrv.load().subscribe(()=>{let n=this.tokenService.referrer.url||"/";n.includes("/passport")&&(n="/"),this.router.navigateByUrl(n)})})}open(t,n="href"){let a="",f="";switch(Ie.production?f=`https://ng-alain.github.io/ng-alain/#/passport/callback/${t}`:f=`http://localhost:4200/#/passport/callback/${t}`,t){case"auth0":a=`//cipchk.auth0.com/login?client=8gcNydIDzGBYxzqV0Vm1CX_RXH-wsWo5&redirect_uri=${decodeURIComponent(f)}`;break;case"github":a=`//github.com/login/oauth/authorize?client_id=9d6baae4b04a23fcafa2&response_type=code&redirect_uri=${decodeURIComponent(f)}`;break;case"weibo":a=`https://api.weibo.com/oauth2/authorize?client_id=1239507802&response_type=code&redirect_uri=${decodeURIComponent(f)}`;break}n==="window"?this.socialService.login(a,"/",{type:"window"}).subscribe(S=>{S&&(this.settingsService.setUser(S),this.router.navigateByUrl("/"))}):this.socialService.login(a,"/",{type:"href"})}ngOnDestroy(){this.interval$&&clearInterval(this.interval$)}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=b({type:i,selectors:[["passport-login"]],standalone:!0,features:[re([A]),N],decls:26,vars:18,consts:[["nz-form","","role","form",3,"ngSubmit","formGroup"],[1,"tabs",3,"nzSelectChange","nzAnimated"],[3,"nzTitle"],[1,"mb-lg"],["nzErrorTip","Please enter userName."],["nzSize","large","nzPrefixIcon","user"],["nz-input","","formControlName","userName","placeholder","username"],["nzErrorTip","Please enter password."],["nzSize","large","nzPrefixIcon","lock"],["nz-input","","type","password","formControlName","password","placeholder","password"],[3,"nzSpan"],["nz-checkbox","","formControlName","remember"],[1,"text-right",3,"nzSpan"],[1,"forgot"],["nz-button","","type","submit","nzType","primary","nzSize","large","nzBlock","",3,"nzLoading"],[1,"mb-lg",3,"nzType","nzMessage","nzShowIcon"]],template:function(n,a){n&1&&(o(0,"form",0),y("ngSubmit",function(){return a.submit()}),o(1,"nz-tabset",1),y("nzSelectChange",function(S){return a.switch(S)}),o(2,"nz-tab",2),l(3,"i18n"),h(4,ct,1,3,"nz-alert",3),o(5,"nz-form-item")(6,"nz-form-control",4)(7,"nz-input-group",5),z(8,"input",6),s()()(),o(9,"nz-form-item")(10,"nz-form-control",7)(11,"nz-input-group",8),z(12,"input",9),s()()()()(),o(13,"nz-form-item")(14,"nz-col",10)(15,"label",11),u(16),l(17,"i18n"),s()(),o(18,"nz-col",12)(19,"a",13),u(20),l(21,"i18n"),s()()(),o(22,"nz-form-item")(23,"button",14),u(24),l(25,"i18n"),s()()()),n&2&&(p("formGroup",a.form),r(),p("nzAnimated",!1),r(),p("nzTitle",m(3,10,"app.login.tab-login-credentials")),r(2),_(4,a.error?4:-1),r(10),p("nzSpan",12),r(2),C(m(17,12,"app.login.remember-me")),r(2),p("nzSpan",12),r(2),C(m(21,14,"app.login.forgot-password")),r(3),p("nzLoading",a.loading),r(),v(" ",m(25,16,"app.login.login")," "))},dependencies:[$,L,F,O,U,q,G,E,Re,De,Le,Ue,Oe,de,ue,Z,K,Y,J,X,Q,H,W,j,M,T,k,I,Be,ke],styles:["[_nghost-%COMP%]{display:block;width:368px;margin:0 auto}[_nghost-%COMP%]     .ant-tabs .ant-tabs-bar{margin-bottom:24px;text-align:center;border-bottom:0}[_nghost-%COMP%]     .ant-tabs-tab{font-size:16px;line-height:24px}[_nghost-%COMP%]     .ant-input-affix-wrapper .ant-input:not(:first-child){padding-left:4px}[_nghost-%COMP%]     .icon{cursor:pointer;margin-left:16px;font-size:24px;color:#0003;vertical-align:middle;transition:color .3s}[_nghost-%COMP%]     .icon:hover{color:#1890ff}[_nghost-%COMP%]     .other{margin-top:24px;line-height:22px;text-align:left}[_nghost-%COMP%]     .other nz-tooltip{vertical-align:middle}[_nghost-%COMP%]     .other .register{float:right}[data-theme=dark]   [_nghost-%COMP%]     .icon{color:#fff3}[data-theme=dark]   [_nghost-%COMP%]     .icon:hover{color:#fff}"],changeDetection:0});let e=i;return e})();function ot(e,i){return c=>{let t=c.get(e),n=c.get(i);return n.errors&&!n.errors.matchControl||(t.value!==n.value?n.setErrors({matchControl:!0}):n.setErrors(null)),null}}var ut=()=>({"width.px":240});function dt(e,i){if(e&1&&z(0,"nz-alert",23),e&2){let c=P();p("nzType","error")("nzMessage",c.error)("nzShowIcon",!0)}}function ft(e,i){e&1&&(u(0),l(1,"i18n")),e&2&&v(" ",m(1,1,"validation.email.required")," ")}function gt(e,i){e&1&&(u(0),l(1,"i18n")),e&2&&v(" ",m(1,1,"validation.email.wrong-format")," ")}function zt(e,i){if(e&1&&h(0,ft,2,3)(1,gt,2,3),e&2){let c=i.$implicit;_(0,c.errors!=null&&c.errors.required?0:-1),r(),_(1,c.errors!=null&&c.errors.email?1:-1)}}function ht(e,i){e&1&&(o(0,"div",27),u(1),l(2,"i18n"),s()),e&2&&(r(),C(m(2,1,"validation.password.strength.strong")))}function vt(e,i){e&1&&(o(0,"div",28),u(1),l(2,"i18n"),s()),e&2&&(r(),C(m(2,1,"validation.password.strength.medium")))}function Ct(e,i){e&1&&(o(0,"div",29),u(1),l(2,"i18n"),s()),e&2&&(r(),C(m(2,1,"validation.password.strength.short")))}function _t(e,i){if(e&1&&(o(0,"div",24),h(1,ht,3,3)(2,vt,3,3)(3,Ct,3,3),o(4,"div"),z(5,"nz-progress",25),s(),o(6,"p",26),u(7),l(8,"i18n"),s()()),e&2){let c,t=P();r(),_(1,(c=t.status)==="ok"?1:c==="pass"?2:3),r(3),Ce("progress-",t.status,""),r(),p("nzPercent",t.progress)("nzStatus",t.passwordProgressMap[t.status])("nzStrokeWidth",6)("nzShowInfo",!1),r(2),C(m(8,9,"validation.password.strength.msg"))}}function St(e,i){e&1&&(u(0),l(1,"i18n")),e&2&&v(" ",m(1,1,"validation.confirm-password.required")," ")}function bt(e,i){e&1&&(u(0),l(1,"i18n")),e&2&&v(" ",m(1,1,"validation.password.twice")," ")}function yt(e,i){if(e&1&&h(0,St,2,3)(1,bt,2,3),e&2){let c=i.$implicit;_(0,c.errors!=null&&c.errors.required?0:-1),r(),_(1,c.errors!=null&&c.errors.matchControl?1:-1)}}function Nt(e,i){e&1&&(o(0,"nz-select",30),z(1,"nz-option",31)(2,"nz-option",31),s()),e&2&&(r(),p("nzLabel","+86")("nzValue","+86"),r(),p("nzLabel","+87")("nzValue","+87"))}function wt(e,i){e&1&&(u(0),l(1,"i18n")),e&2&&v(" ",m(1,1,"validation.phone-number.required")," ")}function xt(e,i){e&1&&(u(0),l(1,"i18n")),e&2&&v(" ",m(1,1,"validation.phone-number.wrong-format")," ")}function kt(e,i){if(e&1&&h(0,wt,2,3)(1,xt,2,3),e&2){let c=i.$implicit;_(0,c.errors!=null&&c.errors.required?0:-1),r(),_(1,c.errors!=null&&c.errors.pattern?1:-1)}}var at=(()=>{let i=class i{constructor(){this.router=d(B),this.http=d(pe),this.cdr=d(ne),this.form=d(me).nonNullable.group({mail:["",[g.required,g.email]],password:["",[g.required,g.minLength(6),i.checkPassword.bind(this)]],confirm:["",[g.required,g.minLength(6)]],mobilePrefix:["+86"],mobile:["",[g.required,g.pattern(/^1\d{10}$/)]],captcha:["",[g.required]]},{validators:ot("password","confirm")}),this.error="",this.type=0,this.loading=!1,this.visible=!1,this.status="pool",this.progress=0,this.passwordProgressMap={ok:"success",pass:"normal",pool:"exception"},this.count=0}static checkPassword(t){if(!t)return null;let n=this;n.visible=!!t.value,t.value&&t.value.length>9?n.status="ok":t.value&&t.value.length>5?n.status="pass":n.status="pool",n.visible&&(n.progress=t.value.length*10>100?100:t.value.length*10)}getCaptcha(){let{mobile:t}=this.form.controls;if(t.invalid){t.markAsDirty({onlySelf:!0}),t.updateValueAndValidity({onlySelf:!0});return}this.count=59,this.cdr.detectChanges(),this.interval$=setInterval(()=>{this.count-=1,this.cdr.detectChanges(),this.count<=0&&clearInterval(this.interval$)},1e3)}submit(){if(this.error="",Object.keys(this.form.controls).forEach(n=>{let a=this.form.controls[n];a.markAsDirty(),a.updateValueAndValidity()}),this.form.invalid)return;let t=this.form.value;this.loading=!0,this.cdr.detectChanges(),this.http.post("/register",t,null,{context:new oe().set(le,!0)}).pipe(te(()=>{this.loading=!1,this.cdr.detectChanges()})).subscribe(()=>{this.router.navigate(["passport","register-result"],{queryParams:{email:t.mail}})})}ngOnDestroy(){this.interval$&&clearInterval(this.interval$)}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=b({type:i,selectors:[["passport-register"]],standalone:!0,features:[N],decls:50,vars:34,consts:[["mailErrorTip",""],["pwdCdkTpl",""],["confirmErrorTip",""],["addOnBeforeTemplate",""],["mobileErrorTip",""],["nz-form","","role","form",3,"ngSubmit","formGroup"],[1,"mb-lg"],[3,"nzErrorTip"],["nzSize","large","nzAddonBeforeIcon","user"],["nz-input","","formControlName","mail","placeholder","Email"],["nzSize","large","nzAddonBeforeIcon","lock","nz-popover","","nzPopoverPlacement","right","nzPopoverTrigger","focus","nzPopoverOverlayClassName","register-password-cdk",3,"nzPopoverVisibleChange","nzPopoverVisible","nzPopoverOverlayStyle","nzPopoverContent"],["nz-input","","type","password","formControlName","password","placeholder","Password"],["nzSize","large","nzAddonBeforeIcon","lock"],["nz-input","","type","password","formControlName","confirm","placeholder","Confirm Password"],["nzSize","large",3,"nzAddOnBefore"],["formControlName","mobile","nz-input","","placeholder","Phone number"],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzSpan"],["nzSize","large","nzAddonBeforeIcon","mail"],["nz-input","","formControlName","captcha","placeholder","Captcha"],["type","button","nz-button","","nzSize","large","nzBlock","",3,"click","disabled","nzLoading"],["nz-button","","nzType","primary","nzSize","large","type","submit",1,"submit",3,"nzLoading"],["routerLink","/passport/login",1,"login"],[1,"mb-lg",3,"nzType","nzMessage","nzShowIcon"],[2,"padding","4px 0"],[3,"nzPercent","nzStatus","nzStrokeWidth","nzShowInfo"],[1,"mt-sm"],[1,"success"],[1,"warning"],[1,"error"],["formControlName","mobilePrefix",2,"width","100px"],[3,"nzLabel","nzValue"]],template:function(n,a){if(n&1){let f=ie();o(0,"h3"),u(1),l(2,"i18n"),s(),o(3,"form",5),y("ngSubmit",function(){return D(f),R(a.submit())}),h(4,dt,1,3,"nz-alert",6),o(5,"nz-form-item")(6,"nz-form-control",7)(7,"nz-input-group",8),z(8,"input",9),s(),h(9,zt,2,2,"ng-template",null,0,x),s()(),o(11,"nz-form-item")(12,"nz-form-control",7),l(13,"i18n"),o(14,"nz-input-group",10),ye("nzPopoverVisibleChange",function(ee){return D(f),be(a.visible,ee)||(a.visible=ee),R(ee)}),z(15,"input",11),s(),h(16,_t,9,11,"ng-template",null,1,x),s()(),o(18,"nz-form-item")(19,"nz-form-control",7)(20,"nz-input-group",12),z(21,"input",13),s(),h(22,yt,2,2,"ng-template",null,2,x),s()(),o(24,"nz-form-item")(25,"nz-form-control",7)(26,"nz-input-group",14),h(27,Nt,3,4,"ng-template",null,3,x),z(29,"input",15),s(),h(30,kt,2,2,"ng-template",null,4,x),s()(),o(32,"nz-form-item")(33,"nz-form-control",7),l(34,"i18n"),o(35,"div",16)(36,"div",17)(37,"nz-input-group",18),z(38,"input",19),s()(),o(39,"div",17)(40,"button",20),y("click",function(){return D(f),R(a.getCaptcha())}),u(41),l(42,"i18n"),s()()()()(),o(43,"nz-form-item")(44,"button",21),u(45),l(46,"i18n"),s(),o(47,"a",22),u(48),l(49,"i18n"),s()()()}if(n&2){let f=w(10),S=w(17),ee=w(23),st=w(28),lt=w(31);r(),C(m(2,21,"app.register.register")),r(2),p("formGroup",a.form),r(),_(4,a.error?4:-1),r(2),p("nzErrorTip",f),r(6),p("nzErrorTip",m(13,23,"validation.password.required")),r(2),Se("nzPopoverVisible",a.visible),p("nzPopoverOverlayStyle",Ne(33,ut))("nzPopoverContent",S),r(5),p("nzErrorTip",ee),r(6),p("nzErrorTip",lt),r(),p("nzAddOnBefore",st),r(7),p("nzErrorTip",m(34,25,"validation.verification-code.required")),r(2),p("nzGutter",8),r(),p("nzSpan",16),r(3),p("nzSpan",8),r(),p("disabled",a.count>0)("nzLoading",a.loading),r(),v(" ",a.count?a.count+"s":m(42,27,"app.register.get-verification-code")," "),r(3),p("nzLoading",a.loading),r(),v(" ",m(46,29,"app.register.register")," "),r(3),C(m(49,31,"app.register.sign-in"))}},dependencies:[$,L,F,O,U,q,G,E,ae,de,ue,Z,K,Y,J,X,Q,H,W,j,je,We,Ye,He,Fe,Ve,Ae,ce,M,T,k,I],styles:["[_nghost-%COMP%]{display:block;width:368px;margin:0 auto}[_nghost-%COMP%]     h3{margin-bottom:20px;font-size:16px}[_nghost-%COMP%]     .submit{width:50%}[_nghost-%COMP%]     .login{float:right;line-height:40px}  .register-password-cdk .success,   .register-password-cdk .warning,   .register-password-cdk .error{transition:color .3s}  .register-password-cdk .success{color:#52c41a}  .register-password-cdk .warning{color:#faad14}  .register-password-cdk .error{color:#ff4d4f}  .register-password-cdk .progress-pass>.progress .ant-progress-bg{background-color:#faad14}"],changeDetection:0});let e=i;return e})();var It=e=>({email:e});function Tt(e,i){if(e&1&&(o(0,"div",4),u(1),l(2,"i18n"),s()),e&2){let c=P();r(),v(" ",xe(2,1,"app.register-result.msg",we(4,It,c.email))," ")}}var pt=(()=>{let i=class i{constructor(){this.msg=d(Te),this.email=""}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=b({type:i,selectors:[["passport-register-result"]],inputs:{email:"email"},standalone:!0,features:[N],decls:10,vars:11,consts:[["title",""],["type","success",3,"title","description"],["nz-button","","nzSize","large",3,"click","nzType"],["routerLink","/","nz-button","","nzSize","large"],[1,"title",2,"font-size","20px"]],template:function(n,a){if(n&1){let f=ie();o(0,"result",1),l(1,"i18n"),h(2,Tt,3,6,"ng-template",null,0,x),o(4,"button",2),y("click",function(){return D(f),R(a.msg.success("email"))}),u(5),l(6,"i18n"),s(),o(7,"button",3),u(8),l(9,"i18n"),s()()}if(n&2){let f=w(3);_e("description",m(1,5,"app.register-result.activation-email")),p("title",f),r(4),p("nzType","primary"),r(),v(" ",m(6,7,"app.register-result.view-mailbox")," "),r(3),v(" ",m(9,9,"app.register-result.back-home")," ")}},dependencies:[ae,E,M,T,k,I,Je,Xe],encapsulation:2});let e=i;return e})();var or=[{path:"passport",component:Ke,children:[{path:"login",component:nt,data:{title:"\u767B\u5F55",titleI18n:"app.login.login"}},{path:"register",component:at,data:{title:"\u6CE8\u518C",titleI18n:"app.register.register"}},{path:"register-result",component:pt,data:{title:"\u6CE8\u518C\u7ED3\u679C",titleI18n:"app.register.register"}},{path:"lock",component:rt,data:{title:"\u9501\u5C4F",titleI18n:"app.lock"}}]},{path:"passport/callback/:type",component:Qe}];export{or as routes};
