import{P as j,R as k,ha as st,ja as rt}from"./chunk-HCTXQRD3.js";import{$a as S,Ca as d,Da as C,Ea as B,Ha as P,Hb as L,Ib as H,K as W,Kb as I,La as a,Lb as x,Ua as f,Va as F,Vb as X,Zb as Y,_a as y,aa as Z,ab as E,db as D,dc as tt,ea as q,ec as et,fa as A,ia as V,ib as U,jc as it,kb as c,lb as G,mb as J,p as T,pb as h,qb as b,rb as M,wa as N,wb as K,xb as v,xf as lt,yc as nt,yf as ot,za as $}from"./chunk-7CJ5GJTD.js";var mt=["orgEl"],ut=["shadowOrgEl"],ft=["shadowTextEl"];function ht(t,o){t&1&&D(0)}function _t(t,o){if(t&1&&E(0,"div",6),t&2){let s=c(3);a("innerHTML",s.orgHtml,N)}}var gt=()=>({"overflow-wrap":"break-word","word-wrap":"break-word"});function dt(t,o){if(t&1&&(y(0,"span",3),f(1,ht,1,0,"ng-container",4)(2,_t,1,1,"ng-template",null,5,x),S()),t&2){let s=h(3),e=c().$implicit;a("nzTooltipTitle",s)("nzTooltipOverlayStyle",K(3,gt)),d(1),a("ngTemplateOutlet",e)}}function Ct(t,o){t&1&&D(0)}function xt(t,o){if(t&1&&f(0,Ct,1,0,"ng-container",4),t&2){let s=c().$implicit;a("ngTemplateOutlet",s)}}function Tt(t,o){if(t&1&&f(0,dt,4,4,"span",3)(1,xt,1,1),t&2){let s=c();F(0,s.tooltip?0:1)}}function yt(t,o){if(t&1&&E(0,"span",7),t&2){let s=c();a("ngClass",s.cls)}}function Et(t,o){}function vt(t,o){if(t&1&&b(0),t&2){let s=c(2);M(s.text)}}var z=t=>({$implicit:t});function wt(t,o){if(t&1&&f(0,Et,0,0,"ng-template",8)(1,vt,1,1,"ng-template",null,9,x),t&2){let s=h(2);c();let e=h(4);a("ngTemplateOutlet",e)("ngTemplateOutletContext",v(2,z,s))}}function Ot(t,o){}var St=t=>({"-webkit-line-clamp":t,"-webkit-box-orient":"vertical"});function bt(t,o){if(t&1&&E(0,"div",11),t&2){let s=c(2);a("ngClass",s.cls)("ngStyle",v(2,St,s.lines))}}function Mt(t,o){if(t&1&&f(0,Ot,0,0,"ng-template",8)(1,bt,1,4,"ng-template",null,10,x),t&2){let s=h(2);c();let e=h(4);a("ngTemplateOutlet",e)("ngTemplateOutletContext",v(2,z,s))}}function Lt(t,o){}function Ht(t,o){if(t&1&&b(0),t&2){let s=c(2);M(s.linsWord)}}function It(t,o){if(t&1&&(y(0,"div",7)(1,"div",12),f(2,Lt,0,0,"ng-template",8)(3,Ht,1,1,"ng-template",null,13,x),E(5,"div",14,15),y(7,"div",16,17)(9,"span"),b(10),S()()()()),t&2){let s=h(4),e=c(),i=h(4);a("ngClass",e.cls),d(2),a("ngTemplateOutlet",i)("ngTemplateOutletContext",v(5,z,s)),d(3),a("innerHTML",e.orgHtml,N),d(5),M(e.text)}}var Rt=["*"],Vt=(()=>{let o=class o{get linsWord(){let{targetCount:e,text:i,tail:n}=this;return(e>0?i.substring(0,e):"")+(e>0&&e<i.length?n:"")}get win(){return this.doc.defaultView||window}constructor(e,i,n,l,r){this.el=e,this.ngZone=i,this.dom=n,this.doc=l,this.cdr=r,this.isSupportLineClamp=this.doc.body.style.webkitLineClamp!==void 0,this.inited=!1,this.type="default",this.cls={},this.text="",this.targetCount=0,this.tooltip=!1,this.fullWidthRecognition=!1,this.tail="..."}getStrFullLength(e){return e.split("").reduce((i,n)=>{let l=n.charCodeAt(0);return l>=0&&l<=128?i+1:i+2},0)}cutStrByFullLength(e,i){let n=0;return e.split("").reduce((l,r)=>{let p=r.charCodeAt(0);return p>=0&&p<=128?n+=1:n+=2,n<=i?l+r:l},"")}bisection(e,i,n,l,r,p){let g=this.tail;p.innerHTML=r.substring(0,i)+g;let u=p.offsetHeight;return u<=e?(p.innerHTML=r.substring(0,i+1)+g,u=p.offsetHeight,u>e||i===n?i:(n=i,i=l-n===1?n+1:Math.floor((l-n)/2)+n,this.bisection(e,i,n,l,r,p))):i-1<0?i:(p.innerHTML=r.substring(0,i-1)+g,u=p.offsetHeight,u<=e?i-1:(l=i,i=Math.floor((l-n)/2)+n,this.bisection(e,i,n,l,r,p)))}genType(){let{lines:e,length:i,isSupportLineClamp:n}=this;this.cls={ellipsis:!0,ellipsis__lines:e&&!n,"ellipsis__line-clamp":e&&n},!e&&!i?this.type="default":e?n?this.type="line-clamp":this.type="line":this.type="length"}gen(){let{type:e,lines:i,length:n,fullWidthRecognition:l,tail:r,orgEl:p,cdr:g,ngZone:u}=this;if(e==="length"){let w=p.nativeElement;if(w.children.length>0)throw new Error("Ellipsis content must be string.");let _=w.textContent;if((l?this.getStrFullLength(_):_.length)<=n||n<0)this.text=_;else{let m;n-r.length<=0?m="":m=l?this.cutStrByFullLength(_,n):_.slice(0,n),this.text=m+r}u.run(()=>g.detectChanges())}else if(e==="line"){let{shadowOrgEl:w,shadowTextEl:_}=this,O=w.nativeElement,m=O.innerText||O.textContent,pt=parseInt(this.win.getComputedStyle(this.getEl(".ellipsis")).lineHeight,10),R=i*pt;if(this.getEl(".ellipsis__handle").style.height=`${R}px`,O.offsetHeight<=R)this.text=m,this.targetCount=m.length;else{let Q=m.length,at=Math.ceil(Q/2),ct=this.bisection(R,at,0,Q,m,_.nativeElement.firstChild);this.text=m,this.targetCount=ct}u.run(()=>g.detectChanges())}}getEl(e){return this.el.nativeElement.querySelector(e)}executeOnStable(e){this.ngZone.isStable?e():this.ngZone.onStable.asObservable().pipe(W(1)).subscribe(e)}refresh(){this.genType();let{type:e,dom:i,orgEl:n,cdr:l}=this,r=n.nativeElement.innerHTML;this.orgHtml=i.bypassSecurityTrustHtml(r),l.detectChanges(),this.executeOnStable(()=>{if(this.gen(),e!=="line"){let p=this.getEl(".ellipsis");p&&(p.innerHTML=r)}})}ngAfterViewInit(){this.inited=!0,this.refresh()}ngOnChanges(){this.inited&&this.refresh()}};o.\u0275fac=function(i){return new(i||o)(C($),C(P),C(nt),C(X),C(B))},o.\u0275cmp=q({type:o,selectors:[["ellipsis"]],viewQuery:function(i,n){if(i&1&&(H(mt,5),H(ut,5),H(ft,5)),i&2){let l;L(l=I())&&(n.orgEl=l.first),L(l=I())&&(n.shadowOrgEl=l.first),L(l=I())&&(n.shadowTextEl=l.first)}},inputs:{tooltip:"tooltip",length:"length",lines:"lines",fullWidthRecognition:"fullWidthRecognition",tail:"tail"},exportAs:["ellipsis"],features:[V],ngContentSelectors:Rt,decls:9,vars:1,consts:[[2,"display","none",3,"cdkObserveContent"],["orgEl",""],["tooltipTpl",""],["nz-tooltip","",3,"nzTooltipTitle","nzTooltipOverlayStyle"],[4,"ngTemplateOutlet"],["titleTpl",""],[3,"innerHTML"],[3,"ngClass"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["lengthTpl",""],["lineClampTpl",""],[3,"ngClass","ngStyle"],[1,"ellipsis__handle"],["lineTpl",""],[1,"ellipsis__shadow",3,"innerHTML"],["shadowOrgEl",""],[1,"ellipsis__shadow"],["shadowTextEl",""]],template:function(i,n){if(i&1&&(G(),y(0,"div",0,1),U("cdkObserveContent",function(){return n.refresh()}),J(2),S(),f(3,Tt,2,1,"ng-template",null,2,x)(5,yt,1,1)(6,wt,3,4)(7,Mt,3,4)(8,It,11,7)),i&2){let l;d(5),F(5,(l=n.type)==="default"?5:l==="length"?6:l==="line-clamp"?7:l==="line"?8:-1)}},dependencies:[Y,et,tt,lt,st],encapsulation:2,changeDetection:0});let t=o;return T([j()],t.prototype,"tooltip",void 0),T([k(null)],t.prototype,"length",void 0),T([k(null)],t.prototype,"lines",void 0),T([j()],t.prototype,"fullWidthRecognition",void 0),t})();var $t=(()=>{let o=class o{};o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=A({type:o}),o.\u0275inj=Z({imports:[it,ot,rt]});let t=o;return t})();export{Vt as a,$t as b};
